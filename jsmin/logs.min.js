angular.module("Logs",["ngRoute","ngCookies"]).config(["$routeProvider","$locationProvider",function(e){e.when("/",{controller:"ListCtrl",templateUrl:"views/list.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"views/login.html"}).when("/new",{controller:"NewCtrl",templateUrl:"views/new.html"}).otherwise({redirectTo:"/"})}]).controller("LogsCtrl",["$scope","$http","$q","$cookies",function(e,t,o,n){e.data=null,t({method:"post",url:"data/data.json"}).success(function(a){var r=new o.defer;r.promise.then(function(){var t=JSON.parse(localStorage.getItem("newData"));if(null!=t&&"true"==n.connected){e.data=a;for(var o=t.length-1;o>=0;o--)e.data.logs.push(t[o]);var t=null;localStorage.setItem("newData",t)}else e.data=a;return e}).then(function(e){t({method:"post",url:"data/save.php",data:e.data}).success(function(t){e.data=t,localStorage.setItem("savedData",JSON.stringify(t))})}),r.resolve()}).error(function(){var t=JSON.parse(localStorage.getItem("newData")),a=new o.defer;a.promise.then(function(){return null!=JSON.parse(localStorage.getItem("savedData"))?e.data=JSON.parse(localStorage.getItem("savedData")):e.data.logs=new Array,e}).then(function(e){if(null!=t&&"true"==n.connected)for(var o=t.length-1;o>=0;o--)e.data.logs.push(t[o])}),a.resolve()})}]).controller("ListCtrl",["$scope",function(){}]).controller("LoginCtrl",["$scope","$http","$cookies",function(e,t,o){e.login=function(){t({method:"post",url:"data/login.php",data:e.mdp}).success(function(e){o.connected=e})}}]).controller("NewCtrl",["$scope","$q","$cookies",function(e,t,o){e.post=function(){if("true"==o.connected&&e.content){var n=new t.defer;n.promise.then(function(){return e.new=JSON.parse(localStorage.getItem("newData"))?JSON.parse(localStorage.getItem("newData")):new Array,e}).then(function(e){e.date=(new Date).getTime(),e.new.push({content:e.content,date:e.date});var t=e.new;localStorage.setItem("newData",JSON.stringify(t))}),n.resolve(),window.location.replace("")}}}]);